<Window x:Class="AFFA.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:AFFA"
        Title="AFFA - Automated Financial and Fundamental Analysis"
        Width="800" Height="600"
        MinWidth="800" MinHeight="600"
        ContentRendered="MainWindow_ContentRendered">
    <Window.Resources>
        <DataTemplate x:Key="Header">
            <TextBlock Text="{Binding Header}" TextWrapping="WrapWithOverflow"/>
        </DataTemplate>

        <DataTemplate x:Key="Data">
            <TextBlock Text="{Binding Data}" TextWrapping="WrapWithOverflow"/>
        </DataTemplate>

        <x:Array x:Key="RetrBasic" Type="{x:Type local:DataItem}">
            <local:DataItem Header="Data start date:" Data="7/31/2005"/>
            <local:DataItem Header="Data end date:" Data="7/31/2011"/>
        </x:Array>

        <x:Array x:Key="RetrBasic2" Type="{x:Type local:DataItem}">
            <local:DataItem Header="Sector:" Data="Technology"/>
            <local:DataItem Header="Industry" Data="Networking and Communications Devices"/>
            <local:DataItem Header="Full time employees" Data="66,689"/>
            <local:DataItem Header="Data start date:" Data="7/31/2005"/>
            <local:DataItem Header="Data end date:" Data="7/31/2011"/>
        </x:Array>

    </Window.Resources>
    <Grid Background="#FFCCCCCC" x:Name="gridMainWindow">
        <DockPanel HorizontalAlignment="Stretch">
            <DockPanel Height="45" DockPanel.Dock="Top">
                <StackPanel Orientation="Horizontal">
                    <Label Name="labelAndmeteAllikas" Content="Company ticker:" Width="100" Height="25" FontWeight="Bold" VerticalContentAlignment="Center" HorizontalContentAlignment="Right" VerticalAlignment="Center" Padding="0" Margin="10,0,0,0"></Label>
                    <TextBox Name="txtBoxAndmeteAllikas" Text="input company ticker here" Width="200" Height="25" VerticalContentAlignment="Center" VerticalAlignment="Center" Margin="10,0,0,0" Foreground="#FFCCCCCC" GotFocus="txtBoxAndmeteAllikas_GotFocus" LostFocus="txtBoxAndmeteAllikas_LostFocus"></TextBox>
                    <Label Content="Source:" Height="25" FontSize="12" FontWeight="Bold" VerticalContentAlignment="Center" VerticalAlignment="Center" Padding="0" Margin="15,0,0,0"></Label>
                    <ComboBox Name="comboDataSource" SelectedIndex="1" Width="120" VerticalAlignment="Center" Height="25" Margin="10,0,0,0" Padding="10,0" VerticalContentAlignment="Center" SelectionChanged="ComboDataSource_SelectionChanged">
                        <ComboBoxItem Name="comboDataSourceItemYCharts">YCharts.com</ComboBoxItem>
                        <ComboBoxItem Name="comboDataSourceItemXMLFile">XML file</ComboBoxItem>
                    </ComboBox>
                    <Button Name="btnLaeAndmed" Content="Retrieve data" Margin="15,0,0,0" Click="btnRetrieveYCharts_Click" Height="25" Width="100" VerticalAlignment="Center" VerticalContentAlignment="Center" Background="Silver" Padding="10,0"></Button>
                    <Button Name="btnAvaXMLFail" Content="Browse" Margin="15,0,0,0" Height="25" Width="100" VerticalAlignment="Center" VerticalContentAlignment="Center" Background="Silver" Visibility="Collapsed" Click="btnAvaXMLFail_Click"></Button>
                    <Button Name="btnLaeYChartsExcelData" Content="Excel" Height="25" Margin="10,0,0,0" Click="btnLaeYChartsExcelData_Click"></Button>
                </StackPanel>
                <StackPanel DockPanel.Dock="Right" VerticalAlignment="Center" Margin="0,0,10,0">
                    <Button Name="btnSeaded" HorizontalAlignment="Right" BorderThickness="1" Height="25" VerticalAlignment="Center" Padding="10,0" Click="btnSeaded_Click">
                        <StackPanel Orientation="Horizontal">
                            <Image Source="Pildid/settings4.png" Width="14" Height="14" RenderOptions.BitmapScalingMode="NearestNeighbor" RenderOptions.EdgeMode="Aliased"></Image>
                            <Label Content="Settings" Height="25" VerticalContentAlignment="Center" VerticalAlignment="Center" Padding="0" Margin="5,0,0,0"></Label>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </DockPanel>
            <DockPanel DockPanel.Dock="Bottom" Height="30">
                <StackPanel Width="200" Orientation="Horizontal" HorizontalAlignment="Stretch" DockPanel.Dock="Right">
                    <Label Content="" VerticalAlignment="Center" Padding="0" Margin="10,0"></Label>
                </StackPanel>
                <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                    <Label Name="labelProgrammiStaatus" Content="No data retrieved. Please input company ticker." VerticalAlignment="Center" Padding="0" Margin="10,0"></Label>
                </StackPanel>
            </DockPanel>
            <TabControl HorizontalAlignment="Stretch" Background="#FFE5E5E5" Margin="10,0,10,0">
                <TabItem>
                    <TabItem.Header>
                        <Label Content="Input data" Padding="6,3"></Label>
                    </TabItem.Header>
                    <StackPanel Orientation="Vertical">
                        <TextBlock Text="Retrieved basic information:" Margin="10,10,0,0"></TextBlock>
                        <Grid x:Name="gridInputDataSplitter">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*"></ColumnDefinition>
                                <ColumnDefinition Width="1*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition></RowDefinition>
                            </Grid.RowDefinitions>
                            <StackPanel x:Name="panelProfileData" Grid.Column="0" Margin="10,10,5,0">
                                <StackPanel VerticalAlignment="Top">
                                    <ListView x:Name="listViewCompanyDetails" ItemsSource="{Binding CompanyDatas}" SizeChanged="listViewCompanyDetails_SizeChanged">
                                        <ListView.View>
                                            <GridView>
                                                <GridViewColumn Header="Field" Width="150" DisplayMemberBinding="{Binding DataFieldDescription}">
                                                </GridViewColumn>
                                                <GridViewColumn Header="Value" Width="Auto" DisplayMemberBinding="{Binding DataFieldContent}" x:Name="ValueColumn">
                                                </GridViewColumn>
                                            </GridView>
                                        </ListView.View>
                                    </ListView>
                                </StackPanel>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Margin="5,10,10,0">
                                <StackPanel VerticalAlignment="Top" HorizontalAlignment="Stretch">
                                    <ListView ItemsSource="{Binding Source={StaticResource RetrBasic}}" HorizontalContentAlignment="Stretch" x:Name="Rbas">
                                        <ListView.View>
                                            <GridView>
                                                <GridViewColumn Width="150" CellTemplate="{StaticResource Header}">
                                                </GridViewColumn>
                                                <GridViewColumn Width="Auto" CellTemplate="{StaticResource Data}">
                                                </GridViewColumn>
                                            </GridView>
                                        </ListView.View>
                                    </ListView>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </TabItem>
                <TabItem>
                    <TabItem.Header>
                        <Label Content="Model output" Padding="6,3"></Label>
                    </TabItem.Header>
                    <DockPanel></DockPanel>
                </TabItem>
                <TabItem>
                    <TabItem.Header>
                        <Label Content="Quarterly data" Padding="6,3"></Label>
                    </TabItem.Header>
                    <DockPanel x:Name="panelQuarterlyData">
                        <DataGrid x:Name="dataGrid" ItemsSource="{Binding ShowTable}" AutoGenerateColumns="False" HorizontalAlignment="Left" Margin="10,10,0,0" VerticalAlignment="Top"/>
                    </DockPanel>
                </TabItem>
                <TabItem>
                    <TabItem.Header>
                        <Label Content="Forecast" Padding="6,3"></Label>
                    </TabItem.Header>
                    <DockPanel x:Name="panelForecast">
                        <DataGrid x:Name="dataGridForecast" ItemsSource="{Binding ShowForecastTable}" AutoGenerateColumns="False" HorizontalAlignment="Left" Margin="10,10,0,0" VerticalAlignment="Top"/>
                        
                    </DockPanel>
                </TabItem>
                <TabItem>
                    <TabItem.Header>
                        <Label Content="Stock chart" Padding="6,3"></Label>
                    </TabItem.Header>
                    <DockPanel>
                        <Grid Width="587" Margin="0,10,0,95" HorizontalAlignment="Left">
                            <Button Content="EpsDiluted" HorizontalAlignment="Left" Margin="10,10,0,0" VerticalAlignment="Top" Width="100" Click="Button_Click_EpsDiluted"/>
                            <Button Content="Revenue" HorizontalAlignment="Left" Margin="10,40,0,0" VerticalAlignment="Top" Width="100" Click="Button_Click_Revenue"/>
                            <Button Content="GrossProfitMargin" HorizontalAlignment="Left" Margin="10,70,0,0" VerticalAlignment="Top" Width="100" Click="Button_Click_GrossProfitMargin"/>
                            <Button Content="OperatingMargin" HorizontalAlignment="Left" Margin="10,100,0,0" VerticalAlignment="Top" Width="100" Click="Button_Click_OperatingMargin"/>
                            <Button Content="ProfitMargin" HorizontalAlignment="Left" Margin="10,130,0,0" VerticalAlignment="Top" Width="100" Click="Button_Click_ProfitMargin"/>

                            <Button Content="Button" HorizontalAlignment="Left" Margin="120,10,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="120,40,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="120,70,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="120,100,0,0" VerticalAlignment="Top" Width="100"/>

                            <Button Content="Button" HorizontalAlignment="Left" Margin="230,10,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="230,40,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="230,70,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="230,100,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="230,130,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="230,160,0,0" VerticalAlignment="Top" Width="100"/>

                            <Button Content="Button" HorizontalAlignment="Left" Margin="340,10,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="340,40,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="340,70,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="340,100,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="340,130,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="340,160,0,0" VerticalAlignment="Top" Width="100"/>

                            <Button Content="Button" HorizontalAlignment="Left" Margin="450,10,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="450,40,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="450,70,0,0" VerticalAlignment="Top" Width="100"/>
                            <Button Content="Button" HorizontalAlignment="Left" Margin="450,100,0,0" VerticalAlignment="Top" Width="100"/>
                        </Grid>
                    </DockPanel>
                </TabItem>
            </TabControl>
        </DockPanel>


    </Grid>
</Window>

